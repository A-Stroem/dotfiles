# ============================================================
# Example .envrc for WORK machine
# This file should NOT be committed to git!
# ============================================================

# IMPORTANT: Add .envrc to .gitignore in your project

# ----------------------------
# Customer Context
# ----------------------------
export CUSTOMER_CONTEXT="acme-corp"

# ----------------------------
# Python Virtual Environment
# ----------------------------
layout uv

# ----------------------------
# Secrets from Files (WORK PATTERN)
# ----------------------------
# Store secrets in ~/.secrets/ directory (gitignored)
# Or use company's secrets management system

# Option 1: Load from local secret files
if [ -f ~/.secrets/elastic-acme-api-key ]; then
  export ELASTIC_API_KEY=$(cat ~/.secrets/elastic-acme-api-key)
fi

if [ -f ~/.secrets/kibana-acme-password ]; then
  export KIBANA_PASSWORD=$(cat ~/.secrets/kibana-acme-password)
fi

# Option 2: Use company secrets management CLI
# Example: AWS Secrets Manager
# export ELASTIC_API_KEY=$(aws secretsmanager get-secret-value --secret-id elastic-acme-api-key --query SecretString --output text)

# Example: HashiCorp Vault
# export ELASTIC_API_KEY=$(vault kv get -field=api_key secret/elastic/acme)

# Example: Company-specific tool
# export ELASTIC_API_KEY=$(company-secrets get elastic-acme-api-key)

# ----------------------------
# Ansible Vault (file-based)
# ----------------------------
# Store vault password in a file
export ANSIBLE_VAULT_FILE="$HOME/.secrets/ansible-vault-acme"

# Or use company's vault system
# export ANSIBLE_VAULT_PASSWORD=$(company-secrets get ansible-vault-acme)

# ----------------------------
# AWS Configuration
# ----------------------------
export AWS_PROFILE="acme-prod"
export AWS_REGION="eu-west-1"

# If using SSO:
# aws sso login --profile acme-prod

# ----------------------------
# Kubernetes Configuration
# ----------------------------
kubectl config use-context "acme-prod" 2>/dev/null || true

# ----------------------------
# Project-Specific Settings
# ----------------------------
export ANSIBLE_INVENTORY="inventory/production.yml"
export ANSIBLE_FORCE_COLOR=true
export ANSIBLE_HOST_KEY_CHECKING=False

# ----------------------------
# API Endpoints
# ----------------------------
export API_BASE_URL="https://api.acme-corp.com"
export KIBANA_URL="https://kibana.acme-corp.com"

# ----------------------------
# Notification on load
# ----------------------------
echo "ğŸ¢ Loaded work environment for: $CUSTOMER_CONTEXT"
echo "â˜¸ï¸  K8s context: $(kubectl config current-context 2>/dev/null || echo 'not set')"
echo "â˜ï¸  AWS profile: ${AWS_PROFILE:-not set}"
echo "ğŸ” Using company secrets management"
