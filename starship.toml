# ============================================================
# Starship prompt - optimized for context + risk awareness
# Security-focused for MSSP/SOC operations
# ============================================================

# Format string
add_newline = false

format = """
$hostname\
$directory\
$git_branch\
$git_status\
$kubernetes\
$aws\
$python\
$nodejs\
$rust\
$golang\
$terraform\
$env_var\
$direnv\
$cmd_duration\
$line_break\
$character
"""

# ----------------------------
# Hostname - only show when SSH'd
# ----------------------------
[hostname]
ssh_only = true
format = "[$hostname]($style) "
style = "bold red"
trim_at = "."

# ----------------------------
# Directory
# ----------------------------
[directory]
truncate_to_repo = true
truncation_length = 4
truncation_symbol = "‚Ä¶/"
style = "bold cyan"
read_only = " üîí"
read_only_style = "bold red"

# ----------------------------
# Git branch
# ----------------------------
[git_branch]
format = "[$symbol$branch]($style) "
symbol = " "
style = "bold purple"
truncation_length = 30
truncation_symbol = "‚Ä¶"

# ----------------------------
# Git status - show dirty state
# ----------------------------
[git_status]
format = "[$all_status$ahead_behind]($style) "
style = "bold yellow"
conflicted = "‚ö†Ô∏è"
ahead = "‚á°${count}"
behind = "‚á£${count}"
diverged = "‚áï‚á°${ahead_count}‚á£${behind_count}"
untracked = "?${count}"
stashed = "$${count}"
modified = "!${count}"
staged = "+${count}"
renamed = "¬ª${count}"
deleted = "‚úò${count}"

# ----------------------------
# Kubernetes context - CRITICAL for MSSP
# ----------------------------
[kubernetes]
disabled = false
format = "[‚éà $context/$namespace]($style) "
style = "bold purple"
# Only show in specific directories (optional)
# detect_files = ['k8s', 'kubernetes', 'kube']
# detect_folders = ['k8s', 'kubernetes', '.kube']

[kubernetes.context_aliases]
"prod-.*" = "üî¥ PROD"
"staging-.*" = "üü° STAGING"
"dev-.*" = "üü¢ DEV"

# ----------------------------
# AWS profile
# ----------------------------
[aws]
disabled = false
format = "[aws:$profile]($style) "
style = "bold yellow"
symbol = "‚òÅÔ∏è "

# ----------------------------
# Customer context (MSSP workflow)
# ----------------------------
[env_var.CUSTOMER_CONTEXT]
variable = "CUSTOMER_CONTEXT"
format = "[üè¢ $env_value]($style) "
style = "bold red"
disabled = false

# ----------------------------
# direnv status - show when environment is loaded
# ----------------------------
[direnv]
disabled = false
format = "[$symbol$loaded/$allowed]($style) "
symbol = "üìÇ"
style = "bold yellow"
loaded_msg = "‚úì"
unloaded_msg = "‚úó"
allowed_msg = "‚úì"
denied_msg = "‚úó"

# ----------------------------
# Python version
# ----------------------------
[python]
format = "[py $version]($style) "
style = "bold yellow"
symbol = " "
# Only show when in Python project
detect_extensions = ['py']
detect_files = ['requirements.txt', 'pyproject.toml', 'Pipfile', '.python-version']
detect_folders = ['.venv', 'venv']

# ----------------------------
# Node.js version
# ----------------------------
[nodejs]
format = "[node $version]($style) "
style = "bold green"
symbol = " "
detect_extensions = ['js', 'mjs', 'cjs', 'ts']
detect_files = ['package.json', '.node-version', '.nvmrc']

# ----------------------------
# Rust version
# ----------------------------
[rust]
format = "[rust $version]($style) "
style = "bold red"
symbol = " "
detect_extensions = ['rs']
detect_files = ['Cargo.toml']

# ----------------------------
# Go version
# ----------------------------
[golang]
format = "[go $version]($style) "
style = "bold cyan"
symbol = " "
detect_extensions = ['go']
detect_files = ['go.mod', 'go.sum']

# ----------------------------
# Terraform version
# ----------------------------
[terraform]
format = "[tf $version]($style) "
style = "bold purple"
symbol = "üí† "
detect_extensions = ['tf', 'tfplan', 'tfstate']
detect_folders = ['.terraform']

# ----------------------------
# Docker context
# ----------------------------
[docker_context]
format = "[docker $context]($style) "
style = "bold blue"
symbol = " "
only_with_files = true
detect_files = ['docker-compose.yml', 'docker-compose.yaml', 'Dockerfile']

# ----------------------------
# Command duration
# ----------------------------
[cmd_duration]
min_time = 500
format = "[took $duration]($style) "
style = "bold blue"
show_milliseconds = false

# ----------------------------
# Character - changes on error
# ----------------------------
[character]
success_symbol = "[‚ûú](bold green)"
error_symbol = "[‚ûú](bold red)"
vimcmd_symbol = "[‚ùÆ](bold green)"

# ----------------------------
# Time (optional - disabled by default)
# ----------------------------
[time]
disabled = true
format = "[$time]($style) "
time_format = "%H:%M"
style = "bold white"

# ----------------------------
# Battery (optional - disabled by default)
# ----------------------------
[battery]
disabled = true
full_symbol = "üîã"
charging_symbol = "‚ö°"
discharging_symbol = "üíÄ"

[[battery.display]]
threshold = 10
style = "bold red"

[[battery.display]]
threshold = 30
style = "bold yellow"

# ----------------------------
# Memory usage (optional - disabled by default)
# ----------------------------
[memory_usage]
disabled = true
format = "[mem $ram]($style) "
threshold = 70
style = "bold yellow"
